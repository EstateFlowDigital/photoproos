# CMS Advanced Features - Testing Guide

This guide covers testing for **Phase 14-16** of the Marketing CMS and **Homepage Editing**:
- Phase 14: Content Governance
- Phase 15: Real-time Collaborative Editing
- Phase 16: Custom Workflow Builder
- **NEW: Homepage CMS Editing**

---

## Table of Contents

1. [Quick Start Setup](#quick-start-setup)
2. [Homepage CMS Editing](#homepage-cms-editing) â† NEW
3. [Phase 14: Content Governance](#phase-14-content-governance)
4. [Phase 15: Collaborative Editing](#phase-15-collaborative-editing)
5. [Phase 16: Workflow Builder](#phase-16-workflow-builder)
6. [Integration Examples](#integration-examples)
7. [Troubleshooting](#troubleshooting)

---

## Quick Start Setup

### 1. Run Database Migration

Before testing, ensure the database schema is up to date:

```bash
npx prisma db push
```

### 2. Seed Default Data (Optional)

Initialize default governance policies and workflows:

```typescript
// In a server action or API route
import { seedDefaultPolicies } from "@/lib/cms/governance-engine";
import { seedDefaultWorkflows } from "@/lib/cms/workflow-engine";

await seedDefaultPolicies();
await seedDefaultWorkflows();
```

### 3. Import Components

```typescript
import {
  // Governance
  GovernanceCheck,
  GovernanceBadge,
  GovernanceDashboard,

  // Collaboration
  CollaborativeEditor,
  ParticipantAvatars,
  CollabStatus,
  CollabField,

  // Workflows
  WorkflowBuilder,
  WorkflowDashboard,
  WorkflowInstanceStatus,
} from "@/components/cms";
```

---

## Homepage CMS Editing

Edit the homepage content directly from the CMS. Changes reflect on the live site after publishing.

### How It Works

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    HOMEPAGE EDITING FLOW                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  1. Navigate to CMS        2. Edit Content       3. Publish     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ /super-admin/   â”‚  â†’   â”‚  Change hero    â”‚ â†’ â”‚  Click    â”‚  â”‚
â”‚  â”‚ marketing/      â”‚      â”‚  title, stats,  â”‚   â”‚  Publish  â”‚  â”‚
â”‚  â”‚ homepage        â”‚      â”‚  CTA text...    â”‚   â”‚           â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                 â”‚
â”‚  4. Cache Revalidates     5. Live Site Updates                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”‚
â”‚  â”‚  ~1 minute      â”‚  â†’   â”‚  Visit /        â”‚                  â”‚
â”‚  â”‚  (or instant    â”‚      â”‚  See new        â”‚                  â”‚
â”‚  â”‚   on publish)   â”‚      â”‚  content!       â”‚                  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Currently Editable Sections

| Section | Editable Fields |
|---------|-----------------|
| **Hero** | Badge, title (muted + main), subtitle, CTAs, social proof items |
| **Logos** | Stats (value, label, suffix), photography types, benefits list |
| **Metrics** | Label, main value/suffix/label, metric cards (value, label, desc) |
| **How It Works** | Badge, title, subtitle, step details (title, description, features) |

### Testing Steps

1. **Seed Default Content** (if homepage has no content):
   ```typescript
   import { seedHomepageContent } from "@/lib/seed/homepage-content";
   await seedHomepageContent();
   ```

2. **Navigate to Homepage Editor**:
   ```
   /super-admin/marketing/homepage
   ```

3. **Edit Hero Section**:
   - Change `titleMain` from "Professional Photographers" to "Photography Pros"
   - Modify `subtitle` text
   - Update social proof items

4. **Click "Save" then "Publish"**

5. **Visit Homepage**:
   ```
   /
   ```

6. **Verify Changes Appear**:
   - New title should show
   - Cache updates within ~1 minute (or instantly if publish triggers revalidation)

### Visual: Editable Hero Fields

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  HERO SECTION - EDITABLE FIELDS                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  badge: "Complete platform"         â† Edit in CMS              â”‚
â”‚  badgeHighlight: "Photography-specific, all-in-one"            â”‚
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  titleMuted: "The Business OS for"        â† Gray text     â”‚ â”‚
â”‚  â”‚  titleMain: "Professional Photographers"  â† White text    â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                 â”‚
â”‚  subtitle: "From booking to delivery..."     â† Edit in CMS     â”‚
â”‚                                                                 â”‚
â”‚  primaryCta:                                                    â”‚
â”‚    label: "Start Free"              â† Button text              â”‚
â”‚    href: "/signup"                  â† Button link              â”‚
â”‚                                                                 â”‚
â”‚  socialProof: [                     â† Array of items           â”‚
â”‚    { text: "Replaces 10+ tools" },                             â”‚
â”‚    { text: "6 photography verticals" },                        â”‚
â”‚    { text: "AI-powered automation" }                           â”‚
â”‚  ]                                                              â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Sections Coming Soon

The following sections will be made CMS-editable in future updates:
- Five Pillars
- Industry Tabs
- Client Experience
- Tool Replacement
- Integration Spotlight
- Case Studies
- Comparison
- Security
- (Testimonials and Pricing already use database content)

---

## Phase 14: Content Governance

Content governance automatically enforces brand standards, SEO requirements, accessibility rules, and more.

### Visual Overview

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    GOVERNANCE DASHBOARD                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚  â”‚ Active   â”‚  â”‚ Warnings â”‚  â”‚ Blocked  â”‚  â”‚ Override â”‚       â”‚
â”‚  â”‚    5     â”‚  â”‚    12    â”‚  â”‚    2     â”‚  â”‚    3     â”‚       â”‚
â”‚  â”‚ policies â”‚  â”‚  total   â”‚  â”‚  items   â”‚  â”‚ required â”‚       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ POLICIES                                    [+ Add New] â”‚   â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
â”‚  â”‚ â—‹ Brand Voice Guidelines         brand_voice    Active  â”‚   â”‚
â”‚  â”‚ â—‹ SEO Requirements               seo            Active  â”‚   â”‚
â”‚  â”‚ â—‹ Accessibility Standards        accessibility  Active  â”‚   â”‚
â”‚  â”‚ â—‹ Content Freshness              freshness      Active  â”‚   â”‚
â”‚  â”‚ â—‹ Publishing Windows             publishing_... Inactiveâ”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Component: GovernanceCheck

Automatically checks content against all active policies.

```tsx
<GovernanceCheck
  entityType="MarketingPage"
  entityId="page-123"
  content={{
    title: "My Page Title",
    body: "Page content here...",
    metaDescription: "SEO description",
  }}
  autoRun={true}
  onComplete={(results) => console.log(results)}
/>
```

**Visual Result:**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Governance Check Results                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                    â”‚
â”‚  âœ“ Brand Voice          Passed                    â”‚
â”‚  âœ“ SEO Requirements     Passed                    â”‚
â”‚  âš  Accessibility        2 warnings                â”‚
â”‚     â””â”€ Missing alt text on 2 images               â”‚
â”‚     â””â”€ Heading hierarchy skips H3                 â”‚
â”‚  âœ— Content Freshness    1 violation               â”‚
â”‚     â””â”€ Content older than 90 days                 â”‚
â”‚                                                    â”‚
â”‚  [Override & Publish]  [Fix Issues]  [Cancel]     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Component: GovernanceBadge

Compact status indicator for list views.

```tsx
<GovernanceBadge
  status="warning"  // "passed" | "warning" | "blocked"
  count={2}
/>
```

**Visual States:**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Governance Badge States                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                     â”‚
â”‚  âœ“ Passed    [  âœ“  ]  Green, checkmark             â”‚
â”‚                                                     â”‚
â”‚  âš  Warning   [ âš  2 ]  Yellow, with count          â”‚
â”‚                                                     â”‚
â”‚  âœ— Blocked   [ âœ— 1 ]  Red, requires resolution    â”‚
â”‚                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Policy Types

| Type | Description | Example Rules |
|------|-------------|---------------|
| `brand_voice` | Enforce brand language | Banned words, required phrases |
| `seo` | SEO requirements | Title length, meta description |
| `accessibility` | WCAG compliance | Alt text, heading hierarchy |
| `freshness` | Content age limits | Update within 90 days |
| `legal_compliance` | Legal requirements | Required disclaimers |
| `approval_gates` | Approval requirements | Require manager sign-off |
| `publishing_windows` | Time restrictions | No weekend publishing |

### Testing Steps

1. **View Governance Dashboard**
   ```
   Navigate to: /admin/cms/governance
   ```

2. **Create a Test Policy**
   - Click "+ Add New" button
   - Fill in policy details:
     ```
     Name: Test SEO Policy
     Type: seo
     Action: warn
     Rules:
       - Field: title, Check: min_length, Value: 10
       - Field: metaDescription, Check: max_length, Value: 160
     ```

3. **Test Content Against Policies**
   - Navigate to any marketing page editor
   - The GovernanceCheck component runs automatically
   - View results in the panel

4. **Resolve Violations**
   - Fix the content issues, OR
   - Click "Override" with a reason

---

## Phase 15: Collaborative Editing

Real-time multi-user editing with presence indicators and cursor tracking.

### Visual Overview

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Marketing Page Editor                    â— 3 editors active    â”‚
â”‚                                           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚                                           â”‚ ğŸ‘¤ You (editing) â”‚  â”‚
â”‚                                           â”‚ ğŸ‘¤ Sarah Chen    â”‚  â”‚
â”‚                                           â”‚ ğŸ‘¤ Mike Johnson  â”‚  â”‚
â”‚                                           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  Title                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ Summer Photography Sale|                                 â”‚   â”‚
â”‚  â”‚                       â†‘                                  â”‚   â”‚
â”‚  â”‚                   [Sarah]  â† cursor indicator            â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                 â”‚
â”‚  Description                                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ Book your summer session today and save 20%...          â”‚   â”‚
â”‚  â”‚                                                     |    â”‚   â”‚
â”‚  â”‚                                                 [Mike]   â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ ğŸŸ¢ Connected â€¢ Last sync: 2s ago â€¢ Version: 42          â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Component: CollaborativeEditor (Provider)

Wrap your editor with this provider to enable collaboration.

```tsx
<CollaborativeEditor
  entityType="MarketingPage"
  entityId="page-123"
  user={{
    id: "user-456",
    name: "John Doe",
    avatar: "/avatars/john.jpg",
  }}
  pollInterval={2000}  // Sync every 2 seconds
>
  {/* Your editor content */}
</CollaborativeEditor>
```

### Component: ParticipantAvatars

Shows who is currently editing.

```tsx
<ParticipantAvatars maxVisible={3} showNames={true} />
```

**Visual:**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Participant Display Options              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                           â”‚
â”‚  Compact (maxVisible=3):                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”â”Œâ”€â”€â”€â”€â”â”Œâ”€â”€â”€â”€â”â”Œâ”€â”€â”€â”€â”                â”‚
â”‚  â”‚ ğŸ‘¤ â”‚â”‚ ğŸ‘¤ â”‚â”‚ ğŸ‘¤ â”‚â”‚ +2 â”‚                â”‚
â”‚  â”‚ JD â”‚â”‚ SC â”‚â”‚ MJ â”‚â”‚    â”‚                â”‚
â”‚  â””â”€â”€â”€â”€â”˜â””â”€â”€â”€â”€â”˜â””â”€â”€â”€â”€â”˜â””â”€â”€â”€â”€â”˜                â”‚
â”‚                                           â”‚
â”‚  With Names (showNames=true):             â”‚
â”‚  â”Œâ”€â”€â”€â”€â” John Doe (you)                   â”‚
â”‚  â”‚ ğŸ‘¤ â”‚ Sarah Chen                       â”‚
â”‚  â””â”€â”€â”€â”€â”˜ Mike Johnson                     â”‚
â”‚                                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Component: CollabField

Wrap form fields to show cursor indicators.

```tsx
<CollabField fieldId="title">
  <input
    type="text"
    value={title}
    onChange={(e) => setTitle(e.target.value)}
  />
</CollabField>
```

### Component: CollabStatus

Shows connection status and sync info.

```tsx
<CollabStatus showVersion={true} />
```

**Visual States:**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Connection Status States                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                     â”‚
â”‚  ğŸŸ¢ Connected     Last sync: 2s ago â€¢ v42          â”‚
â”‚                                                     â”‚
â”‚  ğŸŸ¡ Syncing...    Saving changes...                â”‚
â”‚                                                     â”‚
â”‚  ğŸ”´ Disconnected  Reconnecting in 5s...            â”‚
â”‚                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Cursor Colors

Each participant gets a unique color:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Cursor Color Palette                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  User 1: #3b82f6 (Blue)               â”‚
â”‚  User 2: #22c55e (Green)              â”‚
â”‚  User 3: #f97316 (Orange)             â”‚
â”‚  User 4: #8b5cf6 (Purple)             â”‚
â”‚  User 5: #ec4899 (Pink)               â”‚
â”‚  User 6: #14b8a6 (Teal)               â”‚
â”‚  User 7: #eab308 (Yellow)             â”‚
â”‚  User 8: #ef4444 (Red)                â”‚
â”‚  User 9: #6366f1 (Indigo)             â”‚
â”‚  User 10: #84cc16 (Lime)              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Testing Steps

1. **Open Same Page in Two Browsers**
   - Open the page editor in Chrome
   - Open the same page in Firefox (or incognito)
   - Use different user accounts

2. **Verify Presence Detection**
   - Both users should appear in ParticipantAvatars
   - Avatars show within 2 seconds of joining

3. **Test Cursor Tracking**
   - Click into a field in Browser 1
   - See the cursor indicator appear in Browser 2

4. **Test Conflict Detection**
   - Edit the same field in both browsers
   - Last save wins (polling-based sync)

---

## Phase 16: Workflow Builder

Visual designer for creating content approval workflows.

### Visual Overview

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  WORKFLOW BUILDER                              [Save Workflow]  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚          â”‚                                                      â”‚
â”‚ ADD STEP â”‚           WORKFLOW CANVAS                           â”‚
â”‚          â”‚                                                      â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â” â”‚        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                            â”‚
â”‚ â”‚ âœ“    â”‚ â”‚        â”‚ â–¶ Start       â”‚                            â”‚
â”‚ â”‚Approvâ”‚ â”‚        â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜                            â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”˜ â”‚                â”‚                                     â”‚
â”‚          â”‚                â–¼                                     â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â” â”‚        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                            â”‚
â”‚ â”‚ â—‡    â”‚ â”‚        â”‚ âœ“ Review      â”‚â†â”€â”€â”€ Drag to reposition    â”‚
â”‚ â”‚Conditâ”‚ â”‚        â”‚   (Approval)  â”‚                            â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”˜ â”‚        â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜                            â”‚
â”‚          â”‚           â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”                                â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â” â”‚           â–¼         â–¼                               â”‚
â”‚ â”‚ âš¡   â”‚ â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                        â”‚
â”‚ â”‚Actionâ”‚ â”‚    â”‚ âš¡ Publishâ”‚ â”‚ â–  Reject â”‚                        â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”˜ â”‚    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                        â”‚
â”‚          â”‚         â”‚                                            â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â” â”‚         â–¼                                           â”‚
â”‚ â”‚ ğŸ””   â”‚ â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                     â”‚
â”‚ â”‚Notifyâ”‚ â”‚    â”‚ â–  End    â”‚                                     â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”˜ â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                     â”‚
â”‚          â”‚                                                      â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â” â”‚                                                      â”‚
â”‚ â”‚ â±    â”‚ â”‚                                                      â”‚
â”‚ â”‚Delay â”‚ â”‚                                                      â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”˜ â”‚                                                      â”‚
â”‚          â”‚                                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Step Types

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  WORKFLOW STEP TYPES                                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  â–¶ START (Green)                                               â”‚
â”‚     Entry point - every workflow needs one                      â”‚
â”‚                                                                 â”‚
â”‚  â–  END (Gray)                                                  â”‚
â”‚     Completion point - can have multiple (Approved/Rejected)    â”‚
â”‚                                                                 â”‚
â”‚  âœ“ APPROVAL (Blue)                                             â”‚
â”‚     Requires user approval to proceed                           â”‚
â”‚     Config: approvers[], minApprovals, autoApproveAfter        â”‚
â”‚                                                                 â”‚
â”‚  â—‡ CONDITION (Yellow)                                          â”‚
â”‚     Branch based on rules                                       â”‚
â”‚     Config: field, operator, value â†’ trueStep/falseStep        â”‚
â”‚                                                                 â”‚
â”‚  âš¡ ACTION (Purple)                                             â”‚
â”‚     Perform automated action                                    â”‚
â”‚     Config: publish, unpublish, archive, notify, set_status    â”‚
â”‚                                                                 â”‚
â”‚  â± DELAY (Orange)                                              â”‚
â”‚     Wait before continuing                                      â”‚
â”‚     Config: delayHours, delayUntil (specific time)             â”‚
â”‚                                                                 â”‚
â”‚  ğŸ”” NOTIFICATION (Pink)                                        â”‚
â”‚     Send notifications                                          â”‚
â”‚     Config: notifyUsers[], notifyRoles[], notifyEmail[]        â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Component: WorkflowBuilder

Full visual editor for creating workflows.

```tsx
<WorkflowBuilder
  workflow={existingWorkflow}  // Optional, for editing
  onSave={(workflow) => {
    console.log("Saved:", workflow);
  }}
  onCancel={() => {
    router.back();
  }}
/>
```

### Component: WorkflowDashboard

Management dashboard for all workflows.

```tsx
<WorkflowDashboard />
```

**Visual:**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  WORKFLOW DASHBOARD                                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚    3    â”‚ â”‚    2    â”‚ â”‚    5    â”‚ â”‚   12    â”‚ â”‚    1    â”‚  â”‚
â”‚  â”‚  Total  â”‚ â”‚ Active  â”‚ â”‚ Pending â”‚ â”‚Complete â”‚ â”‚Rejected â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                                    [Init Defaults] [+New]â”‚   â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
â”‚  â”‚                                                         â”‚   â”‚
â”‚  â”‚  Simple Approval              DEFAULT                   â”‚   â”‚
â”‚  â”‚  Basic single-step approval workflow                    â”‚   â”‚
â”‚  â”‚  5 steps â€¢ 2 types            [ğŸ”˜ Active] [ğŸ—‘]          â”‚   â”‚
â”‚  â”‚                                                         â”‚   â”‚
â”‚  â”‚  Two-Stage Approval           DEFAULT                   â”‚   â”‚
â”‚  â”‚  Content reviewed by editor then manager                â”‚   â”‚
â”‚  â”‚  7 steps â€¢ 2 types            [ğŸ”˜ Active] [ğŸ—‘]          â”‚   â”‚
â”‚  â”‚                                                         â”‚   â”‚
â”‚  â”‚  Conditional Approval         DEFAULT                   â”‚   â”‚
â”‚  â”‚  Routes based on content type                           â”‚   â”‚
â”‚  â”‚  7 steps â€¢ 3 types            [âšª Inactive] [ğŸ—‘]        â”‚   â”‚
â”‚  â”‚                                                         â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Component: WorkflowInstanceStatus

Shows current workflow progress for content.

```tsx
<WorkflowInstanceStatus
  instance={workflowInstance}
  onApprove={(comment) => handleApprove(comment)}
  onReject={(reason) => handleReject(reason)}
  onCancel={(reason) => handleCancel(reason)}
/>
```

**Visual:**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Simple Approval                           â— In Progress       â”‚
â”‚  "Summer Photography Sale" page                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                â”‚
â”‚  â†’ Current step: Review (Approval)                            â”‚
â”‚                                                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ Add a comment (optional)                                  â”‚ â”‚
â”‚  â”‚ ____________________________________________              â”‚ â”‚
â”‚  â”‚                                                           â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                â”‚
â”‚  [ âœ“ Approve ]  [ âœ— Reject ]                                  â”‚
â”‚                                                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  History                                                       â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
â”‚  â€¢ Start - started by John Doe                                â”‚
â”‚  â€¢ Review - entered                                           â”‚
â”‚                                                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Default Workflow Templates

#### 1. Simple Approval

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          SIMPLE APPROVAL                â”‚
â”‚                                         â”‚
â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”‚
â”‚         â”‚ â–¶ Start  â”‚                   â”‚
â”‚         â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜                   â”‚
â”‚              â”‚                          â”‚
â”‚              â–¼                          â”‚
â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”‚
â”‚         â”‚ âœ“ Review â”‚ â† Admin approval  â”‚
â”‚         â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜                   â”‚
â”‚         â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”                    â”‚
â”‚         â”‚         â”‚                     â”‚
â”‚         â–¼         â–¼                     â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚
â”‚    â”‚âš¡Publishâ”‚ â”‚â– Rejectedâ”‚              â”‚
â”‚    â””â”€â”€â”€â”¬â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚
â”‚        â”‚                               â”‚
â”‚        â–¼                               â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”                         â”‚
â”‚    â”‚â– Approvedâ”‚                         â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜                         â”‚
â”‚                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### 2. Two-Stage Approval

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚        TWO-STAGE APPROVAL               â”‚
â”‚                                         â”‚
â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”‚
â”‚         â”‚ â–¶ Start  â”‚                   â”‚
â”‚         â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜                   â”‚
â”‚              â”‚                          â”‚
â”‚              â–¼                          â”‚
â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”‚
â”‚         â”‚âœ“ Editor  â”‚ â† Editor review   â”‚
â”‚         â”‚  Review  â”‚                   â”‚
â”‚         â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜                   â”‚
â”‚         â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”                    â”‚
â”‚         â”‚         â”‚                     â”‚
â”‚         â–¼         â–¼                     â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚
â”‚    â”‚âœ“ Managerâ”‚ â”‚â– Rejectedâ”‚             â”‚
â”‚    â”‚ Review  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚
â”‚    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜                        â”‚
â”‚    â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”                        â”‚
â”‚    â”‚         â”‚                         â”‚
â”‚    â–¼         â–¼                         â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”                  â”‚
â”‚ â”‚âš¡Publisâ”‚ â”‚â– Rejectedâ”‚                  â”‚
â”‚ â””â”€â”€â”€â”¬â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â”‚
â”‚     â”‚                                  â”‚
â”‚     â–¼                                  â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”                             â”‚
â”‚ â”‚ğŸ””Notifyâ”‚ â† Notify author            â”‚
â”‚ â””â”€â”€â”€â”¬â”€â”€â”€â”˜                             â”‚
â”‚     â”‚                                  â”‚
â”‚     â–¼                                  â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”                            â”‚
â”‚ â”‚â– Published                            â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜                            â”‚
â”‚                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### 3. Conditional Approval

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚       CONDITIONAL APPROVAL              â”‚
â”‚                                         â”‚
â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”‚
â”‚         â”‚ â–¶ Start  â”‚                   â”‚
â”‚         â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜                   â”‚
â”‚              â”‚                          â”‚
â”‚              â–¼                          â”‚
â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”‚
â”‚         â”‚â—‡ Check   â”‚ â† Is MarketingPage?â”‚
â”‚         â”‚  Type    â”‚                   â”‚
â”‚         â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜                   â”‚
â”‚         â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”                    â”‚
â”‚     YES â”‚         â”‚ NO                 â”‚
â”‚         â–¼         â–¼                     â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚
â”‚    â”‚âœ“Marketingâ”‚ â”‚âœ“ Quick  â”‚            â”‚
â”‚    â”‚ Review  â”‚ â”‚ Review  â”‚            â”‚
â”‚    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜            â”‚
â”‚         â”‚           â”‚                   â”‚
â”‚         â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜                  â”‚
â”‚               â”‚                         â”‚
â”‚               â–¼                         â”‚
â”‚          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”                    â”‚
â”‚          â”‚âš¡Publishâ”‚                    â”‚
â”‚          â””â”€â”€â”€â”¬â”€â”€â”€â”€â”˜                    â”‚
â”‚              â”‚                          â”‚
â”‚              â–¼                          â”‚
â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”                    â”‚
â”‚         â”‚â– Publishedâ”‚                    â”‚
â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                    â”‚
â”‚                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Testing Steps

1. **Access Workflow Dashboard**
   ```
   Navigate to: /admin/cms/workflows
   ```

2. **Initialize Default Workflows**
   - Click "Init Defaults" button
   - Three default workflows will be created

3. **Create Custom Workflow**
   - Click "+ New Workflow"
   - Name it "My Test Workflow"
   - Add steps from the left panel:
     - Drag "Approval" step onto canvas
     - Configure approvers in the right panel
   - Connect steps by editing "Next Steps" IDs
   - Click "Save Workflow"

4. **Test Workflow on Content**
   - Navigate to a marketing page
   - Click "Start Workflow"
   - Select a workflow
   - View the instance status

5. **Complete Workflow**
   - As an approver, view pending items
   - Click "Approve" or "Reject"
   - See workflow advance to next step

---

## Integration Examples

### Complete Page Editor Integration

```tsx
"use client";

import { useState } from "react";
import {
  CollaborativeEditor,
  ParticipantAvatars,
  CollabStatus,
  CollabField,
  GovernanceCheck,
  GovernanceBadge,
  WorkflowInstanceStatus,
} from "@/components/cms";

export function MarketingPageEditor({
  pageId,
  user,
  workflowInstance
}) {
  const [title, setTitle] = useState("");
  const [body, setBody] = useState("");
  const [governanceStatus, setGovernanceStatus] = useState(null);

  return (
    <CollaborativeEditor
      entityType="MarketingPage"
      entityId={pageId}
      user={user}
    >
      <div className="flex flex-col gap-4">

        {/* Header with Collab Status */}
        <div className="flex items-center justify-between">
          <h1>Edit Page</h1>
          <div className="flex items-center gap-4">
            <ParticipantAvatars maxVisible={3} />
            <CollabStatus />
            <GovernanceBadge status={governanceStatus} />
          </div>
        </div>

        {/* Form Fields with Collab Tracking */}
        <CollabField fieldId="title">
          <label>Title</label>
          <input
            value={title}
            onChange={(e) => setTitle(e.target.value)}
            className="w-full p-2 border rounded"
          />
        </CollabField>

        <CollabField fieldId="body">
          <label>Body</label>
          <textarea
            value={body}
            onChange={(e) => setBody(e.target.value)}
            rows={10}
            className="w-full p-2 border rounded"
          />
        </CollabField>

        {/* Governance Check */}
        <GovernanceCheck
          entityType="MarketingPage"
          entityId={pageId}
          content={{ title, body }}
          autoRun={true}
          onComplete={(results) => {
            const hasBlocking = results.some(r => r.action === "block");
            const hasWarnings = results.some(r => r.action === "warn");
            setGovernanceStatus(
              hasBlocking ? "blocked" :
              hasWarnings ? "warning" : "passed"
            );
          }}
        />

        {/* Active Workflow */}
        {workflowInstance && (
          <WorkflowInstanceStatus
            instance={workflowInstance}
            onApprove={() => handleApprove()}
            onReject={() => handleReject()}
          />
        )}

      </div>
    </CollaborativeEditor>
  );
}
```

### Admin Dashboard Integration

```tsx
import {
  GovernanceDashboard,
  WorkflowDashboard,
} from "@/components/cms";

export function CMSAdminPage() {
  return (
    <div className="space-y-8">
      <section>
        <h2>Content Governance</h2>
        <GovernanceDashboard />
      </section>

      <section>
        <h2>Workflow Management</h2>
        <WorkflowDashboard />
      </section>
    </div>
  );
}
```

---

## Troubleshooting

### Common Issues

| Issue | Cause | Solution |
|-------|-------|----------|
| "Unauthorized" errors | User not super admin | Ensure user has super admin role |
| Collaborators not showing | Polling not running | Check CollaborativeEditor provider is wrapping content |
| Workflow not advancing | Missing next step ID | Edit step and set nextSteps array |
| Governance always passing | No active policies | Run seedDefaultPolicies() or create policies |

### Debug Mode

Enable debug logging:

```typescript
// In your .env.local
CMS_DEBUG=true
```

### Database Reset

If you need to reset CMS data:

```bash
# Clear all CMS tables
npx prisma db push --force-reset

# Re-seed defaults
npm run seed:cms
```

---

## API Reference

### Server Actions

| Action | Description |
|--------|-------------|
| `checkContentGovernance()` | Check content against all policies |
| `startCollabSession()` | Join/create collaborative session |
| `syncCollabSession()` | Get participants and edits |
| `startEntityWorkflow()` | Start workflow for content |
| `advanceWorkflowInstance()` | Move workflow to next step |
| `getWorkflowStats()` | Get workflow statistics |

### Hooks

| Hook | Description |
|------|-------------|
| `useCollab()` | Access collaboration context (requires provider) |
| `useCollabOptional()` | Access collab context or null |

---

## Quick Reference Card

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    CMS QUICK REFERENCE                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  GOVERNANCE                                                     â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â”‚  <GovernanceCheck />      Auto-check content against policies  â”‚
â”‚  <GovernanceBadge />      Compact status indicator             â”‚
â”‚  <GovernanceDashboard />  Full policy management               â”‚
â”‚                                                                 â”‚
â”‚  COLLABORATION                                                  â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â”‚  <CollaborativeEditor>    Provider for real-time editing       â”‚
â”‚  <ParticipantAvatars />   Show active editors                  â”‚
â”‚  <CollabStatus />         Connection status                    â”‚
â”‚  <CollabField />          Cursor tracking wrapper              â”‚
â”‚                                                                 â”‚
â”‚  WORKFLOWS                                                      â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â”‚  <WorkflowBuilder />      Visual workflow designer             â”‚
â”‚  <WorkflowDashboard />    Management dashboard                 â”‚
â”‚  <WorkflowInstanceStatus /> Show workflow progress             â”‚
â”‚                                                                 â”‚
â”‚  KEYBOARD SHORTCUTS                                             â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â”‚  Cmd+S          Save content                                   â”‚
â”‚  Escape         Cancel editing                                 â”‚
â”‚  Delete         Remove selected step (workflow builder)        â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

*Last updated: January 2025*
*Covers: Phase 14 (Governance), Phase 15 (Collaboration), Phase 16 (Workflows)*
